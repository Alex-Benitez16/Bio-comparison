---
title: "evidence2"
output: html_document
date: "2025-05-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Library Loading

```{r echo=FALSE}
library(ade4)
library(ape)
library(adegenet)
library(Biostrings)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(ggrepel)
library(stringr)
```

Performing sequence loading

```{r}

countries <- list("usa", "china", "india", "france", "germany", "brazil", "south_korea", "japan", "italy", "uk")
sequences <- lapply(countries, function(x) readDNAStringSet(paste("./sequences/", x, ".fasta", sep="")))

print("The sequence lengths for each genome are as follows")
for (index in 1:length(sequences)) {
  print(
    paste(
      countries[[index]], " = ", width(sequences[[index]]), sep = ""
    )
  )
}

print("The frequencies for each base in each genome are as follows:")
for (index in 1:length(sequences)) {
  a_freq <- letterFrequency(sequences[[index]], 'A')
  c_freq <- letterFrequency(sequences[[index]], 'C')
  g_freq <- letterFrequency(sequences[[index]], 'G')
  t_freq <- letterFrequency(sequences[[index]], 'T')
  
  print(
    paste(
      countries[[index]], ": "
      , "A = ", a_freq
      , ", C = ", c_freq
      , ", G = ", g_freq
      , ", T = ", t_freq
      , ", Sum = ", a_freq + c_freq + g_freq + t_freq
      , sep = ""
    )
  )
}
```

Convert to data frame and graph

```{r}
sequence_dataframe <- data.frame(
  countries = countries,
  a_freq = lapply(sequences, function(seq) letterFrequency(seq, 'A')),
  c_freq = lapply(sequences, function(seq) letterFrequency(seq, 'C')),
  g_freq = lapply(sequences, function(seq) letterFrequency(seq, 'G')),
  t_freq = lapply(sequences, function(seq) letterFrequency(seq, 'T')),
)
```